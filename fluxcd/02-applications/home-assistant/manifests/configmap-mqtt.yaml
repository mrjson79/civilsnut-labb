apiVersion: v1
kind: ConfigMap
metadata:
  name: home-assistant-mqtt-config
  namespace: home-assistant
  labels:
    app: home-assistant
data:
  mqtt.yaml: |
    # MQTT Configuration for Shelly devices
    switch:
      # Anders Office Desk - Gen 1 Shelly Plug S
      - name: "Anders Office Desk"
        state_topic: "shellies/anders_office_desk/relay/0"
        command_topic: "shellies/anders_office_desk/relay/0/command"
        payload_on: "on"
        payload_off: "off"
        availability_topic: "shellies/anders_office_desk/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_anders_office_desk_relay"
        device:
          identifiers: ["anders_office_desk"]
          name: "Anders Office Desk Shelly"
          model: "Shelly Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.179"

      # Lab - Gen 1 Shelly Plug S
      - name: "Lab"
        state_topic: "shellies/lab/relay/0"
        command_topic: "shellies/lab/relay/0/command"
        payload_on: "on"
        payload_off: "off"
        availability_topic: "shellies/lab/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_lab_relay"
        device:
          identifiers: ["shelly_lab"]
          name: "Lab Shelly"
          model: "Shelly Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.183"

      # Master Bedroom - Gen 1 Shelly Plug S
      - name: "Master Bedroom"
        state_topic: "shellies/master_bedroom/relay/0"
        command_topic: "shellies/master_bedroom/relay/0/command"
        payload_on: "on"
        payload_off: "off"
        availability_topic: "shellies/master_bedroom/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_master_bedroom_relay"
        device:
          identifiers: ["shelly_master_bedroom"]
          name: "Master Bedroom Shelly"
          model: "Shelly Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.104"

      # Lab 2 - Gen 2 Shelly Plus Plug S
      - name: "Lab 2"
        state_topic: "lab_2/status/switch:0"
        command_topic: "lab_2/rpc"
        payload_on: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":true}}'
        payload_off: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":false}}'
        value_template: "{{ 'ON' if value_json.output else 'OFF' }}"
        availability_topic: "lab_2/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_lab_2_relay"
        device:
          identifiers: ["shelly_lab_2"]
          name: "Lab 2 Shelly"
          model: "Shelly Plus Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.109"

      # Big Freezer - Gen 2 Shelly Plus Plug S
      - name: "Big Freezer"
        state_topic: "big_freezer/status/switch:0"
        command_topic: "big_freezer/rpc"
        payload_on: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":true}}'
        payload_off: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":false}}'
        value_template: "{{ 'ON' if value_json.output else 'OFF' }}"
        availability_topic: "big_freezer/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_big_freezer_relay"
        device:
          identifiers: ["shelly_big_freezer"]
          name: "Big Freezer Shelly"
          model: "Shelly Plus Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.53"

      # Entertainment - Gen 2 Shelly Plus Plug S
      - name: "Entertainment"
        state_topic: "entertainment/status/switch:0"
        command_topic: "entertainment/rpc"
        payload_on: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":true}}'
        payload_off: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":false}}'
        value_template: "{{ 'ON' if value_json.output else 'OFF' }}"
        availability_topic: "entertainment/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_entertainment_relay"
        device:
          identifiers: ["shelly_entertainment"]
          name: "Entertainment Shelly"
          model: "Shelly Plus Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.64"

      # Cooler - Gen 2 Shelly Plus Plug S
      - name: "Cooler"
        state_topic: "cooler/status/switch:0"
        command_topic: "cooler/rpc"
        payload_on: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":true}}'
        payload_off: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":false}}'
        value_template: "{{ 'ON' if value_json.output else 'OFF' }}"
        availability_topic: "cooler/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_cooler_relay"
        device:
          identifiers: ["shelly_cooler"]
          name: "Cooler Shelly"
          model: "Shelly Plus Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.98"

      # Freezer - Gen 2 Shelly Plus Plug S
      - name: "Freezer"
        state_topic: "freezer/status/switch:0"
        command_topic: "freezer/rpc"
        payload_on: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":true}}'
        payload_off: '{"id":1,"method":"Switch.Set","params":{"id":0,"on":false}}'
        value_template: "{{ 'ON' if value_json.output else 'OFF' }}"
        availability_topic: "freezer/online"
        payload_available: "true"
        payload_not_available: "false"
        unique_id: "shelly_freezer_relay"
        device:
          identifiers: ["shelly_freezer"]
          name: "Freezer Shelly"
          model: "Shelly Plus Plug S"
          manufacturer: "Allterco"
          configuration_url: "http://192.168.3.89"

    sensor:
      # Anders Office Desk Sensors (Gen 1)
      - name: "Anders Office Desk Power"
        state_topic: "shellies/anders_office_desk/relay/0/power"
        unit_of_measurement: "W"
        device_class: "power"
        unique_id: "shelly_anders_office_desk_power"
        device:
          identifiers: ["anders_office_desk"]

      - name: "Anders Office Desk Energy"
        state_topic: "shellies/anders_office_desk/relay/0/energy"
        unit_of_measurement: "Wh"
        device_class: "energy"
        unique_id: "shelly_anders_office_desk_energy"
        device:
          identifiers: ["anders_office_desk"]

      - name: "Anders Office Desk Temperature"
        state_topic: "shellies/anders_office_desk/temperature"
        unit_of_measurement: "°C"
        device_class: "temperature"
        unique_id: "shelly_anders_office_desk_temp"
        device:
          identifiers: ["anders_office_desk"]

      # Lab Sensors (Gen 1)
      - name: "Lab Power"
        state_topic: "shellies/lab/relay/0/power"
        unit_of_measurement: "W"
        device_class: "power"
        unique_id: "shelly_lab_power"
        device:
          identifiers: ["shelly_lab"]

      - name: "Lab Energy"
        state_topic: "shellies/lab/relay/0/energy"
        unit_of_measurement: "Wh"
        device_class: "energy"
        unique_id: "shelly_lab_energy"
        device:
          identifiers: ["shelly_lab"]

      - name: "Lab Temperature"
        state_topic: "shellies/lab/temperature"
        unit_of_measurement: "°C"
        device_class: "temperature"
        unique_id: "shelly_lab_temp"
        device:
          identifiers: ["shelly_lab"]

      # Master Bedroom Sensors (Gen 1)
      - name: "Master Bedroom Power"
        state_topic: "shellies/master_bedroom/relay/0/power"
        unit_of_measurement: "W"
        device_class: "power"
        unique_id: "shelly_master_bedroom_power"
        device:
          identifiers: ["shelly_master_bedroom"]

      - name: "Master Bedroom Energy"
        state_topic: "shellies/master_bedroom/relay/0/energy"
        unit_of_measurement: "Wh"
        device_class: "energy"
        unique_id: "shelly_master_bedroom_energy"
        device:
          identifiers: ["shelly_master_bedroom"]

      - name: "Master Bedroom Temperature"
        state_topic: "shellies/master_bedroom/temperature"
        unit_of_measurement: "°C"
        device_class: "temperature"
        unique_id: "shelly_master_bedroom_temp"
        device:
          identifiers: ["shelly_master_bedroom"]

      # Lab 2 Sensors (Gen 2)
      - name: "Lab 2 Power"
        state_topic: "lab_2/status/switch:0"
        unit_of_measurement: "W"
        device_class: "power"
        value_template: "{{ value_json.apower }}"
        unique_id: "shelly_lab_2_power"
        device:
          identifiers: ["shelly_lab_2"]

      - name: "Lab 2 Energy"
        state_topic: "lab_2/status/switch:0"
        unit_of_measurement: "Wh"
        device_class: "energy"
        value_template: "{{ value_json.aenergy.total }}"
        unique_id: "shelly_lab_2_energy"
        device:
          identifiers: ["shelly_lab_2"]

      - name: "Lab 2 Temperature"
        state_topic: "lab_2/status/switch:0"
        unit_of_measurement: "°C"
        device_class: "temperature"
        value_template: "{{ value_json.temperature.tC }}"
        unique_id: "shelly_lab_2_temp"
        device:
          identifiers: ["shelly_lab_2"]

      - name: "Lab 2 Voltage"
        state_topic: "lab_2/status/switch:0"
        unit_of_measurement: "V"
        device_class: "voltage"
        value_template: "{{ value_json.voltage }}"
        unique_id: "shelly_lab_2_voltage"
        device:
          identifiers: ["shelly_lab_2"]

      - name: "Lab 2 Current"
        state_topic: "lab_2/status/switch:0"
        unit_of_measurement: "A"
        device_class: "current"
        value_template: "{{ value_json.current }}"
        unique_id: "shelly_lab_2_current"
        device:
          identifiers: ["shelly_lab_2"]

      # Big Freezer Sensors (Gen 2)
      - name: "Big Freezer Power"
        state_topic: "big_freezer/status/switch:0"
        unit_of_measurement: "W"
        device_class: "power"
        value_template: "{{ value_json.apower }}"
        unique_id: "shelly_big_freezer_power"
        device:
          identifiers: ["shelly_big_freezer"]

      - name: "Big Freezer Energy"
        state_topic: "big_freezer/status/switch:0"
        unit_of_measurement: "Wh"
        device_class: "energy"
        value_template: "{{ value_json.aenergy.total }}"
        unique_id: "shelly_big_freezer_energy"
        device:
          identifiers: ["shelly_big_freezer"]

      - name: "Big Freezer Temperature"
        state_topic: "big_freezer/status/switch:0"
        unit_of_measurement: "°C"
        device_class: "temperature"
        value_template: "{{ value_json.temperature.tC }}"
        unique_id: "shelly_big_freezer_temp"
        device:
          identifiers: ["shelly_big_freezer"]

      - name: "Big Freezer Voltage"
        state_topic: "big_freezer/status/switch:0"
        unit_of_measurement: "V"
        device_class: "voltage"
        value_template: "{{ value_json.voltage }}"
        unique_id: "shelly_big_freezer_voltage"
        device:
          identifiers: ["shelly_big_freezer"]

      - name: "Big Freezer Current"
        state_topic: "big_freezer/status/switch:0"
        unit_of_measurement: "A"
        device_class: "current"
        value_template: "{{ value_json.current }}"
        unique_id: "shelly_big_freezer_current"
        device:
          identifiers: ["shelly_big_freezer"]

      # Entertainment Sensors (Gen 2)
      - name: "Entertainment Power"
        state_topic: "entertainment/status/switch:0"
        unit_of_measurement: "W"
        device_class: "power"
        value_template: "{{ value_json.apower }}"
        unique_id: "shelly_entertainment_power"
        device:
          identifiers: ["shelly_entertainment"]

      - name: "Entertainment Energy"
        state_topic: "entertainment/status/switch:0"
        unit_of_measurement: "Wh"
        device_class: "energy"
        value_template: "{{ value_json.aenergy.total }}"
        unique_id: "shelly_entertainment_energy"
        device:
          identifiers: ["shelly_entertainment"]

      - name: "Entertainment Temperature"
        state_topic: "entertainment/status/switch:0"
        unit_of_measurement: "°C"
        device_class: "temperature"
        value_template: "{{ value_json.temperature.tC }}"
        unique_id: "shelly_entertainment_temp"
        device:
          identifiers: ["shelly_entertainment"]

      - name: "Entertainment Voltage"
        state_topic: "entertainment/status/switch:0"
        unit_of_measurement: "V"
        device_class: "voltage"
        value_template: "{{ value_json.voltage }}"
        unique_id: "shelly_entertainment_voltage"
        device:
          identifiers: ["shelly_entertainment"]

      - name: "Entertainment Current"
        state_topic: "entertainment/status/switch:0"
        unit_of_measurement: "A"
        device_class: "current"
        value_template: "{{ value_json.current }}"
        unique_id: "shelly_entertainment_current"
        device:
          identifiers: ["shelly_entertainment"]

      # Cooler Sensors (Gen 2)
      - name: "Cooler Power"
        state_topic: "cooler/status/switch:0"
        unit_of_measurement: "W"
        device_class: "power"
        value_template: "{{ value_json.apower }}"
        unique_id: "shelly_cooler_power"
        device:
          identifiers: ["shelly_cooler"]

      - name: "Cooler Energy"
        state_topic: "cooler/status/switch:0"
        unit_of_measurement: "Wh"
        device_class: "energy"
        value_template: "{{ value_json.aenergy.total }}"
        unique_id: "shelly_cooler_energy"
        device:
          identifiers: ["shelly_cooler"]

      - name: "Cooler Temperature"
        state_topic: "cooler/status/switch:0"
        unit_of_measurement: "°C"
        device_class: "temperature"
        value_template: "{{ value_json.temperature.tC }}"
        unique_id: "shelly_cooler_temp"
        device:
          identifiers: ["shelly_cooler"]

      - name: "Cooler Voltage"
        state_topic: "cooler/status/switch:0"
        unit_of_measurement: "V"
        device_class: "voltage"
        value_template: "{{ value_json.voltage }}"
        unique_id: "shelly_cooler_voltage"
        device:
          identifiers: ["shelly_cooler"]

      - name: "Cooler Current"
        state_topic: "cooler/status/switch:0"
        unit_of_measurement: "A"
        device_class: "current"
        value_template: "{{ value_json.current }}"
        unique_id: "shelly_cooler_current"
        device:
          identifiers: ["shelly_cooler"]

      # Freezer Sensors (Gen 2)
      - name: "Freezer Power"
        state_topic: "freezer/status/switch:0"
        unit_of_measurement: "W"
        device_class: "power"
        value_template: "{{ value_json.apower }}"
        unique_id: "shelly_freezer_power"
        device:
          identifiers: ["shelly_freezer"]

      - name: "Freezer Energy"
        state_topic: "freezer/status/switch:0"
        unit_of_measurement: "Wh"
        device_class: "energy"
        value_template: "{{ value_json.aenergy.total }}"
        unique_id: "shelly_freezer_energy"
        device:
          identifiers: ["shelly_freezer"]

      - name: "Freezer Temperature"
        state_topic: "freezer/status/switch:0"
        unit_of_measurement: "°C"
        device_class: "temperature"
        value_template: "{{ value_json.temperature.tC }}"
        unique_id: "shelly_freezer_temp"
        device:
          identifiers: ["shelly_freezer"]

      - name: "Freezer Voltage"
        state_topic: "freezer/status/switch:0"
        unit_of_measurement: "V"
        device_class: "voltage"
        value_template: "{{ value_json.voltage }}"
        unique_id: "shelly_freezer_voltage"
        device:
          identifiers: ["shelly_freezer"]

      - name: "Freezer Current"
        state_topic: "freezer/status/switch:0"
        unit_of_measurement: "A"
        device_class: "current"
        value_template: "{{ value_json.current }}"
        unique_id: "shelly_freezer_current"
        device:
          identifiers: ["shelly_freezer"]
