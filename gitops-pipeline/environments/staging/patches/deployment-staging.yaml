apiVersion: apps/v1
kind: Deployment
metadata:
  name: podinfo
  annotations:
    kargo.akuity.io/environment: "staging"
    kargo.akuity.io/auto-promote: "true"
    deployment.kubernetes.io/revision: "1"
spec:
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxUnavailable: 0
      maxSurge: 1
  template:
    metadata:
      annotations:
        kargo.akuity.io/environment: "staging"
        kargo.akuity.io/color: "#ff6b35"
    spec:
      containers:
      - name: podinfo
        resources:
          limits:
            cpu: 100m
            memory: 128Mi
          requests:
            cpu: 25m
            memory: 32Mi
        livenessProbe:
          httpGet:
            path: /healthz
            port: http
          initialDelaySeconds: 15
          periodSeconds: 5
          timeoutSeconds: 3
          failureThreshold: 2
        readinessProbe:
          httpGet:
            path: /readyz
            port: http
          initialDelaySeconds: 3
          periodSeconds: 3
          timeoutSeconds: 2
          failureThreshold: 2
        env:
        - name: PODINFO_LEVEL
          value: "debug"
        - name: PODINFO_CACHE_SERVER
          value: "redis://redis.podinfo-staging:6379"
